<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Doorprize Berurutan</title>
<style>
  body, html {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
  }

  /* Lapisan background buram */
  .background-blur {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: url('https://github.com/agungrizki1417/doorprizetenismeja/raw/main/PUSKESMAS.jpeg') no-repeat center center fixed;
    background-size: cover;
    filter: blur(8px);
    z-index: -1;
  }

  .container {
    text-align: center;
    padding-top: 50px;
  }

  .title {
    color: green;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
  }

  /* Gaya untuk container roda putar */
  .wheel-container {
    position: relative;
    display: inline-block;
    margin: 20px 0;
  }

  /* Gaya untuk canvas roda */
  #spinwheel {
    border: 5px solid #fff;
    border-radius: 50%;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  /* Tombol putar */
  #spin-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #e74c3c;
    color: white;
    border: none;
    padding: 20px 30px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 50px;
    transition: background-color 0.3s;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  }

  #spin-button:hover {
    background-color: #c0392b;
  }

  #spin-button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
  }

  /* Panah penunjuk */
  .arrow {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 30px solid #e74c3c;
  }
</style>
</head>
<body>

<div class="background-blur"></div>

<div class="container">
  <h1 class="title">üéÅ RODA PUTAR DOORPRIZE TENIS MEJA PUSKESMAS PETANAHAN üéÅ</h1>
  
  <div class="wheel-container">
    <canvas id="spinwheel" width="600" height="600"></canvas>
    <div class="arrow"></div>
    <button id="spin-button">PUTAR!</button>
  </div>
</div>

<script>
  const canvas = document.getElementById('spinwheel');
  const ctx = canvas.getContext('2d');
  const spinBtn = document.getElementById('spin-button');

  let totalRotation = 0;
  let winnerIndex = 0; // Index untuk melacak pemenang saat ini

  // Daftar nama pemenang berurutan
  const sequentialWinners = [
    'Habibullah',
    'Arida Zuhairoh',
    'Siti Zulaikhah Kuntowati',
    'Riska Pramita Hapsari',
    'Imam Jajuli',
    'Ahmad Faozan',
    'Agung Rizki Maulana',
    'dr. R. Sunarko Slamet',
    'Ariyani Muldaningsih',
    'Miyas Indra Utami'
  ];

  const names = [
    'dr. R. Sunarko Slamet', 'Imam Jajuli', 'Wasikin', 'Tri Yuliani', 'Pramono', 
    'Sugiyati', 'Siti Zulaikhah Kuntowati', 'Arida Zuhairoh', 'Riska Pramita Hapsari', 
    'Suryanti', 'Ariyani Muldaningsih', 'Istiqomah', 'Sulsi Astuti', 'Suharjono', 
    'Ratna Andriyani', 'Romeli', 'Maryanti', 'Nur Setiyani', 'dr. Ratna Prabawati Nopiutami', 
    'Diyana Susanti', 'Faoji', 'M. Noer', 'Agung Rizki Maulana', 'Habibullah', 
    'Rifkhi Anisa Wijayanti', 'Ahmad Faozan', 'Miyas Indra Utami', 'Ayu Indrarti', 
    'Habibiena Noviyanti', 'Fitri Nurkhasanah', 'Sunarmono Maulud', 'Fitriyanah', 
    'Yusup Kurniawan', 'Haryanto', 'Fahmi Fajarwati', 'dr. Muhammad Daffa Ramadhan', 
    'Joko Susilo', 'Kesyia Ayuni Asnidatama', 'Faisal Azis Sofian', 'Haryono'
  ];

  const colors = [
    '#FF6F61', '#6B5B95', '#88B04B', '#F7CAC9', '#92A8D1', 
    '#955251', '#B565A7', '#009B77', '#DD4124', '#D64161', 
    '#FF7B25', '#C7D3D4', '#E27D60', '#A9A9A9', '#C0C0C0', 
    '#F4E1D2', '#EDC7B7', '#B3A369', '#E0B589', '#C83349'
  ];

  const numNames = names.length;
  const arcSize = (2 * Math.PI) / numNames;

  function drawWheel() {
    for (let i = 0; i < numNames; i++) {
      const angle = i * arcSize;
      
      ctx.beginPath();
      ctx.arc(300, 300, 300, angle, angle + arcSize);
      ctx.lineTo(300, 300);
      
      const colorIndex = i % colors.length;
      ctx.fillStyle = colors[colorIndex];
      ctx.fill();

      // Menggambar teks nama
      ctx.save();
      ctx.translate(300, 300);
      ctx.rotate(angle + arcSize / 2);
      ctx.textAlign = 'right';
      ctx.fillStyle = '#fff';
      ctx.font = '20px Arial';
      ctx.fillText(names[i], 280, 10);
      ctx.restore();
    }
  }

  function spin() {
    spinBtn.disabled = true;

    // Menentukan pemenang berikutnya dari daftar berurutan
    const winnerName = sequentialWinners[winnerIndex];
    const winningIndexInFullList = names.indexOf(winnerName);

    // Menghitung putaran yang tepat untuk mendarat di pemenang
    const degreesPerSlice = 360 / numNames;
    
    // Hitung posisi tengah dari segmen pemenang. Koordinat canvas: 0 derajat di kanan, 90 di bawah.
    const winningSliceCenter = (winningIndexInFullList * degreesPerSlice) + (degreesPerSlice / 2);
    
    // Posisi jarum penunjuk di bagian atas, yang setara dengan 270 derajat
    // dalam sistem koordinat canvas yang dimulai dari kanan.
    const pointerPosition = 270;
    
    // Menghitung rotasi yang dibutuhkan agar roda berputar maju dan berhenti tepat di pemenang
    const currentRotationMod360 = totalRotation % 360;
    
    // Perbaikan: Menghitung rotasi yang dibutuhkan dari posisi roda saat ini ke posisi pemenang
    let rotationNeeded = (pointerPosition - winningSliceCenter);
    
    // Sesuaikan rotasi jika diperlukan untuk memastikan putaran maju dan lebih dari 360 derajat
    rotationNeeded = (rotationNeeded - currentRotationMod360 + 360) % 360;
    if (rotationNeeded < 0) {
        rotationNeeded += 360;
    }
    
    // Putaran dasar yang besar agar roda berputar beberapa kali untuk efek visual
    const baseRotation = 3600;
    totalRotation += baseRotation + rotationNeeded;
    
    canvas.style.transform = `rotate(${totalRotation}deg)`;

    // Mengatur pemenang berikutnya untuk putaran selanjutnya
    winnerIndex = (winnerIndex + 1) % sequentialWinners.length;

    setTimeout(() => {
      spinBtn.disabled = false;
    }, 6000); 
  }

  spinBtn.addEventListener('click', spin);
  drawWheel();
</script>
</body>
</html>
